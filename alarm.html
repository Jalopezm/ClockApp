<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
</head>

<body>
  DESPERTADOR:
  <div class="timeis" id="time"></div>
  <br />
  <input type="datetime-local" id="datetime">
  <div id="alarmList">
    <ol id="alarms"></ol>
  </div>

  <button id="Add" onclick="saveAlarm()">Add Alarm</button>
  <script>
    setInterval(clock, 1000);

    function clock() {
      let date = new Date();
      document.getElementById("time").innerHTML = date.toLocaleTimeString();
    }

    let alarms = new Array();
    let li;
    let currAlarm = new Date(document.getElementById("datetime").value+":00");

    alarm()
    function alarm() {
      let today = new Date().getTime();
      currAlarm = new Date(document.getElementById("datetime").value+":00");
      let currAlarmMil = currAlarm.getTime();
      for (let index = 0; index < alarms.length; index++) {
        if (alarms[index][1] == true) {
          if (today == currAlarmMil) {
            const audio = new Audio("1.mp4");
            audio.play();
            console.log("ALARMA")
          }
        }

      }


    }


    setInterval(alarm, 1000);


    function saveAlarm() {

      for (let index = 0; index < 1; index++) {
        ol = document.getElementById("alarms");
        ol.remove();
        let newOl = document.createElement("ol");
        newOl.setAttribute("id", "alarms");
        document.getElementById("alarmList").appendChild(newOl);
      }

      let currAlarmTime = currAlarm.toLocaleTimeString();
      let active = false
      let alarmsValues = [currAlarmTime, active];

      alarms.push(alarmsValues);


      for (let index = 0; index < alarms.length; index++) {
        activeButton = document.createElement("button");
        activeButton.innerHTML = "Activate";
        li = document.createElement("li");
        li.textContent = alarms[index][0];
        document.getElementById("alarms").appendChild(li);
        document.getElementById("alarms").appendChild(activeButton);
      }

      activeButton.onclick = function () {
        if (active == false) {
          active = true;
          activeButton.innerHTML = "Desactivate";
        } else {
          active = false;
          activeButton.innerHTML = "Activate";
        }
      };
      localStorageAlarm(alarms);
    }

    function localStorageAlarm(alarms) {
      localStorage.setItem("alarms", alarms);
    }
  </script>
</body>

</html>